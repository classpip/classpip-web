<app-navbar></app-navbar>
<br>
<br>
<div class="wrapper">
  <div class="main">
    <div class="section section-basic" id="basic-elements">

      <div class="container">

        <h2 style="text-align: center;">
          EXPERIENCIAS
        </h2>

        <h4 style="text-align: center;">¡Bienvenido a la página de experiencias, dónde otros profesores comparten sus
          opiniones y consejos sobre su experiencia usando Classpip! </h4>
        <h4 style="text-align: center;">¡Siéntete libre de explicarnos la tuya!</h4>


        <div *ngIf="this.isLogged == true; else loginWarn">
          <div class= "button" data-target="#myModal2" (click)="myModal2.show()" style="text-align: center;">
            <button class="btn btn-success btn-default btn-small" type="submit" >
              Nueva publicación  <i class="tim-icons icon-simple-add"> </i>
            </button>
          </div>
          <!-- <div class="card card-publicacion card-header">
            <form>
              <div class="form-group col-md-4">
                <label for="Titulo publicacion">Título</label>
                <input type="titulo" class="form-control" id="TituloPublicacion"
                  placeholder="Escríbe el título de tu publicación">
              </div>
              <div class="form-group col-md-12">
                <label for="Experiencia">Experiencia</label>
                <textarea class="form-control" id="Experiencia"></textarea>
              </div>
              <div class="card-body" style="text-align: center;">
                <button class="btn btn-success btn-default btn-small" type="submit" (click)="sendPubli()">
                  Publicar
                </button>
              </div>
            </form>
          </div> -->
        </div>
        <ng-template #loginWarn>
          <div class="card card-publicacion card-header">
            <p style="text-align: center;"><a class="login" routerLink="/login">Inicia sesión</a> o <a class="register" routerLink="/register">registarte</a> para poder publicar o comentar experiencias</p>
          </div>
        </ng-template>
        <!-- <br>
        <br>

        <div class="button" style="text-align: center;">
          <button class="btn btn-success btn-round btn-lg" data-target="#myModal2" (click)="myModal2.show()">
            Nueva pulbicación <i class="tim-icons icon-simple-add"> </i> </button>
        </div>-->

        <br>
        <br> 
        <div *ngIf="publicaciones && publicaciones.length != 0; else nopublis">
          <div class="card card-publicacion" *ngFor="let publi of publicaciones;">
            <br>
            <div class="publicacion">
              <div class="publicacion-header">
                <h3 id="publi-title"> {{publi.titulo}} {{publi.id}} {{i}}</h3> 
                <div class="autor" id="autor-name">
                  <img *ngIf="publi.autor.ImagenPerfil == null"  src="../../../assets/img/logo.png" routerLink="/perfil" style="border-radius: 50%"  width="20" height="20" />
                  <img *ngIf="publi.autor.ImagenPerfil != null"  src={{publi.autor.ImagenPerfil}} routerLink="/perfil" style="border-radius: 50%"  width="20" height="20" />  
                  &nbsp;
                  <span>{{publi.autor.Nombre}} {{publi.autor.PrimerApellido}}</span>
                </div>
              </div>
              <br class="hidden-ss">
              <span>{{publi.fecha}}</span>
              <br><br>
              <p>{{publi.publicacion}}</p>
              <br>
              <div class="likes">
                <i class="fas fa-heart" style="font-size:12px;color:red;" (click)="dislike(publi.id)" *ngIf="publi.isLike" ></i> 
                <i class="fas fa-heart" style="font-size:12px;color:white;" (click)="like(publi.id)" *ngIf="!publi.isLike" ></i> 
                &nbsp; 
                <span>{{publi.likes.length}} likes</span>
              </div>
            </div>
            <br>
            <div class="card card-comentario" *ngFor="let comment of publi.comentarios;">
              <div class="comentario">
                <br>
                <p>{{comment.comentario}}</p>
                <p *ngIf="comment.autor" >{{comment.autor.Nombre}}</p>
                <p>{{comment.fecha}}</p>
                <p>{{comment.likes}}</p>
                <br>
              </div>
            </div>
            <div *ngIf="this.isLogged == true">
              <div class="input-group">
                <input id="{{publi.id}}" class="form-control" placeholder="Deja aqui tu comentario" type="text"
                  (focus)="focus2 = true" (blur)="focus2 = false">
                  <div class="input-group-append">
                    <span class="input-group-text"><i id="sendIcon" class="tim-icons icon-send" (click)="sendComment(publi.id)"></i></span>
                  </div>
              </div>
            </div>
          </div>
        </div>
        <ng-template #nopublis>
          <div style="text-align: center;">
            <br><br><br>
            <h2>No hay publicaciones</h2>
          </div>
        </ng-template>
      </div>



    </div>
  </div>
  <!-- </div> -->
  <!-- DEFINICIÓN DEL POPUP DE NUEVA PUBLICACIÓN -->
  <div aria-hidden="true" aria-labelledby="myModalLabel" bsModal class="modal fade modal-black" #myModal2="bs-modal"
  id="myModal2" role="dialog" tabindex="-1">
  <div class="modal-dialog" style="width:1250px;">
    <div class="modal-content">
      <div class="modal-header justify-content-center">
        <button aria-hidden="true" class="close" data-dismiss="modal" (click)="myModal2.hide()" type="button">
          <i class="tim-icons icon-simple-remove text-white"> </i>
        </button>
        
      </div>
      <div class="modal-body" >
        
        <div class="text-center mb-4 mt-3">
          EXPLÍCANOS TU EXPERIENCIA USANDO CLASSPIP
        </div>
        <form role="form">
          <div class="form-group mb-3">              
              <input type="titulo" class="form-control" id="TituloPublicacion"
              placeholder="Escríbe el título de tu publicación" />
            </div>
          <div class="form-group">
            <label for="Experiencia">Experiencia</label>
            <textarea class="form-control" id="Experiencia"></textarea>
            </div>
          <div class="text-center">
            <button class="btn btn-primary my-4" type="button" (click) = "sendPubli()" (click)="myModal2.hide()">
              Publicar
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div> 
  <app-footer></app-footer>